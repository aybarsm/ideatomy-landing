function Vector(t,i){this.x=t||0,this.y=i||0}function GravityPoint(t,i,e,r){Vector.call(this,t,i),this.radius=e,this.currentRadius=.5*e,this._targets={particles:r.particles||[],gravities:r.gravities||[]},this._speed=new Vector}function Particle(t,i,e){Vector.call(this,t,i),this.radius=e,this._latest=new Vector,this._speed=new Vector}window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)},Vector.add=function(t,i){return new Vector(t.x+i.x,t.y+i.y)},Vector.sub=function(t,i){return new Vector(t.x-i.x,t.y-i.y)},Vector.scale=function(t,i){return t.clone().scale(i)},Vector.random=function(){return new Vector(2*Math.random()-1,2*Math.random()-1)},Vector.prototype={set:function(t,i){return"object"==typeof t&&(i=t.y,t=t.x),this.x=t||0,this.y=i||0,this},add:function(t){return this.x+=t.x,this.y+=t.y,this},sub:function(t){return this.x-=t.x,this.y-=t.y,this},scale:function(t){return this.x*=t,this.y*=t,this},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lengthSq:function(){return this.x*this.x+this.y*this.y},normalize:function(){var t=Math.sqrt(this.x*this.x+this.y*this.y);return t&&(this.x/=t,this.y/=t),this},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){var i=t.x-this.x,e=t.y-this.y;return Math.atan2(e,i)},distanceTo:function(t){var i=t.x-this.x,e=t.y-this.y;return Math.sqrt(i*i+e*e)},distanceToSq:function(t){var i=t.x-this.x,e=t.y-this.y;return i*i+e*e},lerp:function(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this},clone:function(){return new Vector(this.x,this.y)},toString:function(){return"(x:"+this.x+", y:"+this.y+")"}},GravityPoint.RADIUS_LIMIT=65,GravityPoint.interferenceToPoint=!0,GravityPoint.prototype=function(t){var i,e=new Vector(0,0);for(i in t)e[i]=t[i];return e}({gravity:.05,isMouseOver:!1,dragging:!1,destroyed:!1,_easeRadius:0,_dragDistance:null,_collapsing:!1,hitTest:function(t){return this.distanceTo(t)<this.radius},startDrag:function(t){this._dragDistance=Vector.sub(t,this),this.dragging=!0},drag:function(t){this.x=t.x-this._dragDistance.x,this.y=t.y-this._dragDistance.y},endDrag:function(){this._dragDistance=null,this.dragging=!1},addSpeed:function(t){this._speed=this._speed.add(t)},collapse:function(t){this.currentRadius*=1.75,this._collapsing=!0},render:function(t){if(!this.destroyed){var i,e,r=this._targets.particles;for(i=0,e=r.length;i<e;i++)r[i].addSpeed(Vector.sub(this,r[i]).normalize().scale(this.gravity));if(this._easeRadius=.95*(this._easeRadius+.07*(this.radius-this.currentRadius)),this.currentRadius+=this._easeRadius,this.currentRadius<0&&(this.currentRadius=0),this._collapsing)return this.radius*=.75,this.currentRadius<1&&(this.destroyed=!0),void this._draw(t);var s,n,a,o=this._targets.gravities,h=this.radius*this.radius*Math.PI;for(i=0,e=o.length;i<e;i++)(s=o[i])===this||s.destroyed||((this.currentRadius>=s.radius||this.dragging)&&this.distanceTo(s)<.85*(this.currentRadius+s.radius)&&(s.destroyed=!0,this.gravity+=s.gravity,n=Vector.sub(s,this).scale(s.radius/this.radius*.5),this.addSpeed(n),a=s.radius*s.radius*Math.PI,this.currentRadius=Math.sqrt((h+3*a)/Math.PI),this.radius=Math.sqrt((h+a)/Math.PI)),s.addSpeed(Vector.sub(this,s).normalize().scale(this.gravity)));GravityPoint.interferenceToPoint&&!this.dragging&&this.add(this._speed),this._speed=new Vector,this.currentRadius>GravityPoint.RADIUS_LIMIT&&this.collapse(),this._draw(t)}},_draw:function(t){var i,e;t.save(),(i=t.createRadialGradient(this.x,this.y,this.radius,this.x,this.y,5*this.radius)).addColorStop(0,"rgba(0, 0, 0, 0.1)"),i.addColorStop(1,"rgba(0, 0, 0, 0)"),t.beginPath(),t.arc(this.x,this.y,5*this.radius,0,2*Math.PI,!1),t.fillStyle=i,t.fill(),e=Math.random()*this.currentRadius*.7+.3*this.currentRadius,(i=t.createRadialGradient(this.x,this.y,e,this.x,this.y,this.currentRadius)).addColorStop(0,"rgba(0, 0, 0, 1)"),i.addColorStop(1,Math.random()<.2?"rgba(255, 196, 0, 0.15)":"rgba(103, 181, 191, 0.75)"),t.beginPath(),t.arc(this.x,this.y,this.currentRadius,0,2*Math.PI,!1),t.fillStyle=i,t.fill(),t.restore()}}),Particle.prototype=function(t){var i,e=new Vector(0,0);for(i in t)e[i]=t[i];return e}({addSpeed:function(t){this._speed.add(t)},update:function(){this._speed.length()>12&&this._speed.normalize().scale(12),this._latest.set(this),this.add(this._speed)}}),function(){var t,i,e,r,s,n,a,o,h=1,d=10,u=new Vector,c=[],l=[];function g(o){s=t.width=window.innerWidth,n=t.height=window.innerHeight,e.width=s,e.height=n,i=t.getContext("2d"),r=e.getContext("2d");var h=.5*t.width,d=.5*t.height;(a=i.createRadialGradient(h,d,0,h,d,Math.sqrt(h*h+d*d))).addColorStop(0,"rgba(0, 0, 0, 0)"),a.addColorStop(1,"rgba(0, 0, 0, 0.35)")}o={particleNum:50},t=document.getElementById("c"),e=document.createElement("canvas"),window.addEventListener("resize",g,!1),g(),function(t){var i,e;for(i=0;i<t;i++)(e=new Particle(Math.floor(Math.random()*s-2*h)+1+h,Math.floor(Math.random()*n-2*h)+1+h,h)).addSpeed(Vector.random()),l.push(e)}(o.particleNum),t.addEventListener("mousemove",function(i){u.set(i.clientX,i.clientY);var e,r,s=!1;for(e=c.length-1;e>=0;e--)r=c[e],!s&&r.hitTest(u)||r.dragging?r.isMouseOver=s=!0:r.isMouseOver=!1;t.style.cursor=s?"pointer":"default"},!1),t.addEventListener("mousedown",function(t){for(var i=c.length-1;i>=0;i--)if(c[i].isMouseOver)return void c[i].startDrag(u);c.push(new GravityPoint(t.clientX,t.clientY,d,{particles:l,gravities:c}))},!1),t.addEventListener("mouseup",function(t){for(var i=0,e=c.length;i<e;i++)if(c[i].dragging){c[i].endDrag();break}},!1),t.addEventListener("dblclick",function(t){for(var i=c.length-1;i>=0;i--)if(c[i].isMouseOver){c[i].collapse();break}},!1);var f=function(){var t,o,d,g;for(i.save(),i.fillStyle="rgba(50, 58, 69, 1)",i.fillRect(0,0,s,n),i.fillStyle=a,i.fillRect(0,0,s,n),i.restore(),t=0,o=c.length;t<o;t++)(d=c[t]).dragging&&d.drag(u),d.render(i),d.destroyed&&(c.splice(t,1),o--,t--);for(r.save(),r.globalCompositeOperation="destination-out",r.globalAlpha=.35,r.fillRect(0,0,s,n),r.restore(),o=l.length,r.save(),r.fillStyle=r.strokeStyle="#fff",r.lineCap=r.lineJoin="round",r.lineWidth=2*h,r.beginPath(),t=0;t<o;t++)(g=l[t]).update(),r.moveTo(g.x,g.y),r.lineTo(g._latest.x,g._latest.y);for(r.stroke(),r.beginPath(),t=0;t<o;t++)g=l[t],r.moveTo(g.x,g.y),r.arc(g.x,g.y,g.radius,0,2*Math.PI,!1);r.fill(),r.restore(),i.drawImage(e,0,0),requestAnimationFrame(f)};f()}();